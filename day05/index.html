<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>day05学习 | 微信小程序学习</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="微信小程序课程笔记内容">
    
    <link rel="preload" href="/wxxcx-docs/assets/css/0.styles.307e88e1.css" as="style"><link rel="preload" href="/wxxcx-docs/assets/js/app.d92135fc.js" as="script"><link rel="preload" href="/wxxcx-docs/assets/js/3.8ee8425d.js" as="script"><link rel="preload" href="/wxxcx-docs/assets/js/5.5b96994b.js" as="script"><link rel="prefetch" href="/wxxcx-docs/assets/js/10.732df8fe.js"><link rel="prefetch" href="/wxxcx-docs/assets/js/11.05814d20.js"><link rel="prefetch" href="/wxxcx-docs/assets/js/12.124b2e60.js"><link rel="prefetch" href="/wxxcx-docs/assets/js/13.e3e010d4.js"><link rel="prefetch" href="/wxxcx-docs/assets/js/2.e125ace9.js"><link rel="prefetch" href="/wxxcx-docs/assets/js/4.faac2375.js"><link rel="prefetch" href="/wxxcx-docs/assets/js/6.1efb0b54.js"><link rel="prefetch" href="/wxxcx-docs/assets/js/7.232c16ba.js"><link rel="prefetch" href="/wxxcx-docs/assets/js/8.9af87980.js"><link rel="prefetch" href="/wxxcx-docs/assets/js/9.c5b84952.js">
    <link rel="stylesheet" href="/wxxcx-docs/assets/css/0.styles.307e88e1.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/wxxcx-docs/" class="home-link router-link-active"><img src="/wxxcx-docs/logo.jpg" alt="微信小程序学习" class="logo"> <span class="site-name can-hide">微信小程序学习</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://developers.weixin.qq.com/miniprogram/dev/framework/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  小程序开发文档
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="课程内容" class="dropdown-title"><span class="title">课程内容</span> <span class="arrow down"></span></button> <button type="button" aria-label="课程内容" class="mobile-dropdown-title"><span class="title">课程内容</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/wxxcx-docs/day01/" class="nav-link">
  day01课程
</a></li><li class="dropdown-item"><!----> <a href="/wxxcx-docs/day02/" class="nav-link">
  day02课程
</a></li><li class="dropdown-item"><!----> <a href="/wxxcx-docs/day03/" class="nav-link">
  day03课程
</a></li><li class="dropdown-item"><!----> <a href="/wxxcx-docs/day04/" class="nav-link">
  day04课程
</a></li><li class="dropdown-item"><!----> <a href="/wxxcx-docs/day05/" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  day05课程
</a></li><li class="dropdown-item"><!----> <a href="https://www.escook.cn/docs-uni-shop/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  黑马优购项目
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><a href="https://mp.weixin.qq.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  微信公众平台
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="相关生态" class="dropdown-title"><span class="title">相关生态</span> <span class="arrow down"></span></button> <button type="button" aria-label="相关生态" class="mobile-dropdown-title"><span class="title">相关生态</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://developers.weixin.qq.com/community/develop/article/doc/000ecc775a86807f7ba9b7dc956c13" target="_blank" rel="noopener noreferrer" class="nav-link external">
  WeUI
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://vant-contrib.gitee.io/vant-weapp/#/home" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Vant Weapp
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://developers.weixin.qq.com/miniprogram/dev/extended/utils/computed.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  框架扩展
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://developers.weixin.qq.com/miniprogram/dev/extended/utils/api-promise.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  工具类库
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://developers.weixin.qq.com/miniprogram/dev/framework/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  小程序开发文档
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="课程内容" class="dropdown-title"><span class="title">课程内容</span> <span class="arrow down"></span></button> <button type="button" aria-label="课程内容" class="mobile-dropdown-title"><span class="title">课程内容</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/wxxcx-docs/day01/" class="nav-link">
  day01课程
</a></li><li class="dropdown-item"><!----> <a href="/wxxcx-docs/day02/" class="nav-link">
  day02课程
</a></li><li class="dropdown-item"><!----> <a href="/wxxcx-docs/day03/" class="nav-link">
  day03课程
</a></li><li class="dropdown-item"><!----> <a href="/wxxcx-docs/day04/" class="nav-link">
  day04课程
</a></li><li class="dropdown-item"><!----> <a href="/wxxcx-docs/day05/" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  day05课程
</a></li><li class="dropdown-item"><!----> <a href="https://www.escook.cn/docs-uni-shop/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  黑马优购项目
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><a href="https://mp.weixin.qq.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  微信公众平台
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="相关生态" class="dropdown-title"><span class="title">相关生态</span> <span class="arrow down"></span></button> <button type="button" aria-label="相关生态" class="mobile-dropdown-title"><span class="title">相关生态</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://developers.weixin.qq.com/community/develop/article/doc/000ecc775a86807f7ba9b7dc956c13" target="_blank" rel="noopener noreferrer" class="nav-link external">
  WeUI
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://vant-contrib.gitee.io/vant-weapp/#/home" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Vant Weapp
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://developers.weixin.qq.com/miniprogram/dev/extended/utils/computed.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  框架扩展
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://developers.weixin.qq.com/miniprogram/dev/extended/utils/api-promise.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  工具类库
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>day05学习</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/wxxcx-docs/day05/#_1、学习目标" class="sidebar-link">1、学习目标</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/wxxcx-docs/day05/#_2、使用npm包" class="sidebar-link">2、使用npm包</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/wxxcx-docs/day05/#_2-1、-小程序对npm-的支持与限制" class="sidebar-link">2.1、小程序对npm 的支持与限制</a></li><li class="sidebar-sub-header"><a href="/wxxcx-docs/day05/#_2-2、-vant-weapp" class="sidebar-link">2.2、 Vant Weapp</a></li><li class="sidebar-sub-header"><a href="/wxxcx-docs/day05/#_2-3、-api的promise化" class="sidebar-link">2.3、 API的Promise化</a></li></ul></li><li><a href="/wxxcx-docs/day05/#_3、全局数据共享" class="sidebar-link">3、全局数据共享</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/wxxcx-docs/day05/#_3-1、-什么是全局数据共享" class="sidebar-link">3.1、 什么是全局数据共享</a></li><li class="sidebar-sub-header"><a href="/wxxcx-docs/day05/#_3-2、安装mobx" class="sidebar-link">3.2、安装Mobx</a></li><li class="sidebar-sub-header"><a href="/wxxcx-docs/day05/#_3-3、构建mobx的store实例" class="sidebar-link">3.3、构建Mobx的Store实例</a></li><li class="sidebar-sub-header"><a href="/wxxcx-docs/day05/#_3-3、使用store的成员" class="sidebar-link">3.3、使用Store的成员</a></li></ul></li><li><a href="/wxxcx-docs/day05/#_4、分包加载" class="sidebar-link">4、分包加载</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/wxxcx-docs/day05/#_4-1、基础概念" class="sidebar-link">4.1、基础概念</a></li><li class="sidebar-sub-header"><a href="/wxxcx-docs/day05/#_4-2、使用分包" class="sidebar-link">4.2、使用分包</a></li><li class="sidebar-sub-header"><a href="/wxxcx-docs/day05/#_4-3、独立分包" class="sidebar-link">4.3、独立分包</a></li><li class="sidebar-sub-header"><a href="/wxxcx-docs/day05/#_4-4、分包预加载" class="sidebar-link">4.4、分包预加载</a></li></ul></li><li><a href="/wxxcx-docs/day05/#_5、自定义tabbar" class="sidebar-link">5、自定义TabBar</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/wxxcx-docs/day05/#_5-1、案例展示" class="sidebar-link">5.1、案例展示</a></li><li class="sidebar-sub-header"><a href="/wxxcx-docs/day05/#_5-2、基本实现" class="sidebar-link">5.2、基本实现</a></li><li class="sidebar-sub-header"><a href="/wxxcx-docs/day05/#_5-3、基于vant-waapp渲染tabbar" class="sidebar-link">5.3、基于vant-waapp渲染tabbar</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="day05学习"><a href="#day05学习" class="header-anchor">#</a> day05学习</h1> <h2 id="_1、学习目标"><a href="#_1、学习目标" class="header-anchor">#</a> 1、学习目标</h2> <table><thead><tr><th>知识点名称</th> <th>知识点内容</th> <th>难度系数</th> <th>要求程度</th></tr></thead> <tbody><tr><td>使用npm包</td> <td>了解对npm的限制，学习Vant Weapp，Api的Promise化</td> <td>3星</td> <td>掌握</td></tr> <tr><td>全局数据共享</td> <td>安装和使用Mobx，数据共享案例</td> <td></td> <td></td></tr> <tr><td>分包</td> <td>分包概念、限制，配置；使用分包、独立分包、分包预加载</td> <td>3星</td> <td>掌握</td></tr> <tr><td>自定义tabBar</td> <td>配置方式、实现案例</td> <td>3星</td> <td>掌握</td></tr></tbody></table> <h2 id="_2、使用npm包"><a href="#_2、使用npm包" class="header-anchor">#</a> 2、使用npm包</h2> <h3 id="_2-1、-小程序对npm-的支持与限制"><a href="#_2-1、-小程序对npm-的支持与限制" class="header-anchor">#</a> **2.1、**小程序对npm <strong>的支持与限制</strong></h3> <p>目前，小程序中已经支持使用 npm 安装第三方包，从而来提高小程序的开发效率。</p> <p>但是，在小程序中使用 npm 包有如下 3 个限制：</p> <p>① 不支持依赖于 Node.js 内置库的包</p> <p>② 不支持依赖于浏览器内置对象的包</p> <p>③ 不支持依赖于 C++ 插件的包</p> <p>总结：虽然 npm 上的包有千千万，但是能供小程序使用的包却“为数不多”。</p> <h3 id="_2-2、-vant-weapp"><a href="#_2-2、-vant-weapp" class="header-anchor">#</a> 2.2、 Vant Weapp</h3> <p><strong>1.</strong> <strong>什么是</strong> Vant Weapp</p> <p>Vant Weapp 是有赞前端团队开源的一套小程序 UI 组件库，助力开发者快速搭建小程序应用。它所使</p> <p>用的是 MIT 开源许可协议，对商业使用比较友好。</p> <p>官方文档地址 https://youzan.github.io/vant-weapp</p> <p>扫描下方的小程序二维码，体验组件库示例：</p> <img src="assets/image-20210730060138920.png" alt="image-20210730060138920" style="zoom:50%;"> <p><strong>2.</strong> <strong>安装</strong> Vant <strong>组件库</strong></p> <p>在小程序项目中，安装 Vant 组件库主要分为如下几 步：</p> <p>① 首先要初始化 package.json 文件</p> <p>在项目根目录执行，以下命令。<code>-y</code> 意思是快速下载，不必询问，都是 <code>yes</code></p> <div class="language-ssh line-numbers-mode"><pre class="language-text"><code>npm init -y 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>② 通过 npm 安装</p> <p>（建议指定版本为@1.3.3）,下载到了项目根目录下的 node-modules</p> <div class="language-ssh line-numbers-mode"><pre class="language-text"><code>npm i @vant/weapp -S --production 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>③ 构建 npm 包 ，使用 npm 模块</p> <p><strong>微信开发者工具 --&gt; 详情 --&gt; 本地设置 --&gt; 使用 npm 模块</strong></p> <p>④ 构建 npm</p> <p><strong>微信开发者工具 --&gt; 菜单栏 --&gt; 工具 --&gt; 构建npm</strong></p> <p><img src="/wxxcx-docs/assets/img/image-20210730060712959.88567b8d.png" alt="image-20210730060712959"></p> <p>⑤ 修改 app.json</p> <p>将 <code>styles: v2</code> 进行移除，防止 小程序本身的 UI 样式和Vant 的组件样式库 冲突</p> <p><strong>3、使用 Vant</strong></p> <p>安装完 Vant 组件库之后，可以在 app.json 的 usingComponents 节点中引入需要的组件，即可在wxml 中</p> <p>直接使用组件，示例代码如下：</p> <ul><li><code>app.json</code>中全局导入组件</li></ul> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token property">&quot;usingComponents&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> 
	<span class="token property">&quot;van-button&quot;</span><span class="token operator">:</span> <span class="token string">&quot;@vant/weapp/button/index&quot;</span> 
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li>页面的.wxml 结构</li></ul> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>van-button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>primary<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>按钮<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>van-button</span><span class="token punctuation">&gt;</span></span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>4.</strong> <strong>定制全局主题样式</strong></p> <ul><li><p>学习CSS变量概念</p> <p>Vant Weapp 使用 CSS 变量来实现定制主题。 关于 CSS 变量的基本用法，请参考 MDN 文档：https://developer.mozilla.org/zh-CN/docs/Web/CSS/Using_CSS_custom_properties</p></li> <li><p>Vant Weapp 定义主体样式</p> <p>在 app.wxss 中，写入 CSS 变量，即可对全局生效：</p></li></ul> <div class="language-css line-numbers-mode"><pre class="language-css"><code><span class="token comment">/* app.wxss */</span> 
<span class="token selector">page:</span> <span class="token punctuation">{</span> 
    <span class="token comment">/* 定制警告按钮的背景颜色 和边框颜色*/</span> 
    <span class="token property">--button-danger-background-color</span><span class="token punctuation">:</span> #c00000<span class="token punctuation">;</span> 
    <span class="token property">--button-danger-border-color</span><span class="token punctuation">:</span> #d60000<span class="token punctuation">;</span> 
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>所有可用的颜色变量，请参考 Vant 官方提供的配置文件：</p> <p>https://github.com/youzan/vant-weapp/blob/dev/packages/common/style/var.less</p> <p><strong>5、vant-weapp 实现响应式</strong></p> <p><strong>思路：</strong> 借助第三方方法 用<code>gulp、gulp-postcss、postcss-pxtransform</code>对<code>miniprogram_npm/vant-weapp</code>下面的wxss进行转换</p> <ul><li><p>命令行执行 <code>npm install gulp gulp-postcss postcss-pxtransform --save-dev</code>   目录下生成<code>node_modules/postcss-pxtransform</code>算成功</p></li> <li><p>在根目录新建<code>gulpfile.js</code>文件gulp是一个类似webpack一样的打包工具，我们这里不需要细致了解</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> gulp <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'gulp'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> postcss <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'gulp-postcss'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> pxtorem <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'postcss-pxtransform'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
gulp<span class="token punctuation">.</span><span class="token function">task</span><span class="token punctuation">(</span><span class="token string">'css'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
 
<span class="token keyword">var</span> processors <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token function">pxtorem</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        platform<span class="token operator">:</span> <span class="token string">'weapp'</span><span class="token punctuation">,</span>
        designWidth<span class="token operator">:</span> <span class="token number">750</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
 
<span class="token keyword">return</span> gulp<span class="token punctuation">.</span><span class="token function">src</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'miniprogram_npm/@vant/**/*.wxss'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">postcss</span><span class="token punctuation">(</span>processors<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>gulp<span class="token punctuation">.</span><span class="token function">dest</span><span class="token punctuation">(</span><span class="token string">'miniprogram_npm/@vant/'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div></li> <li><p>在<code>package.json</code>下面的<code>script</code>添加一个<code>build</code>执行命令</p> <div class="language-js line-numbers-mode"><div class="highlight-lines"><br><br><div class="highlighted"> </div><br><br></div><pre class="language-js"><code><span class="token string">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;test&quot;</span><span class="token operator">:</span> <span class="token string">&quot;echo \&quot;Error: no test specified\&quot; &amp;&amp; exit 1&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;build&quot;</span><span class="token operator">:</span> <span class="token string">&quot;gulp css&quot;</span> 
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></li> <li><p><strong>重要： 修改<code>node_modules/postcss-pxtransform/index.js</code></strong></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> deviceRatio <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token number">640</span><span class="token operator">:</span> <span class="token number">2.34</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">,</span>
   <span class="token comment">// 750: 1, 原来的</span>
  <span class="token number">750</span><span class="token operator">:</span> <span class="token number">2</span> <span class="token operator">/</span> <span class="token number">1</span>  
  <span class="token number">828</span><span class="token operator">:</span> <span class="token number">1.81</span> <span class="token operator">/</span> <span class="token number">2</span>
<span class="token punctuation">}</span>  
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div></li> <li><p>执行<code>npm run build</code>, 显示<code>Finished 'CSS'</code>说明成功！</p> <p><img src="data:image/png;base64,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" alt="image-20210802200302012"></p></li> <li><p>点击  <strong>清缓存--&gt;全部缓存； 点击编译</strong>， 查看发现已经单位变成<code>rpx</code></p> <p><img src="/wxxcx-docs/assets/img/image-20210802200821741.7515d8c2.png" alt="image-20210802200821741"></p></li></ul> <img src="/wxxcx-docs/assets/img/image-20210802201114985.cc501f75.png" alt="image-20210802201114985" style="zoom:80%;"> <p><strong>注意</strong> 一旦修改之后，建议将<code>miniprogram_npm</code>下的<code>@vant</code>文件夹进行拷贝备份，因为一旦删除重新构建，需要再次执行<code>npm run build</code>生成，比较麻烦。 拷贝了，只需要替换即可。</p> <h3 id="_2-3、-api的promise化"><a href="#_2-3、-api的promise化" class="header-anchor">#</a> 2.3、 API的Promise化</h3> <p><strong>1.</strong> <strong>基于回调函数的异步</strong> API <strong>的缺点</strong></p> <p>默认情况下，小程序官方提供的异步 API 都是基于回调函数实现的，例如，网络请求的 API 需要按照如下的方式调用：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>wx<span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">{</span> 
    method<span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span> 
    url<span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span> 
    data<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> 
    <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">// 成功的回调 </span>
    <span class="token function-variable function">complate</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">// 无论成功与否都会执行的回调 </span>
    <span class="token function-variable function">fail</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token comment">// 失败的回调 </span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>这种代码的缺点是显而易见的, <strong>容易造成回调地狱的问题</strong>，代码的可读性、维护性差！而我们就想将这种类型的代码使用 API Promise 化进行改造</p> <p><strong>2.</strong> <strong>什么是</strong> API Promise <strong>化</strong></p> <p>API Promise <strong>化</strong>，指的是通过额外的配置，将官方提供的、基于回调函数的异步 API ，升级改造为基于 Promise 的异步 API ，从而提高代码的可读性、维护性，避免回调地狱的问题。</p> <p><strong>3.</strong> <strong>实现</strong> API Promise <strong>化</strong></p> <p>在小程序中，实现 API Promise 化主要依赖于 <strong>miniprogram-api-promise</strong> 这个第三方的 npm 包。它的安装和使用步骤如下</p> <p>① 安装构建</p> <div class="language-ssh line-numbers-mode"><pre class="language-text"><code>npm i --save miniprogram-api-promise@1.0.4 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>下载完成，我们不能直接使用，而是需要再次重新构建npm包</li> <li>建议在构建前先删除原有的miniprogram_npm</li> <li>然后再点击工具，构建npm</li></ul> <p>② <code>app.js</code>中导入并执行代码</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 在小程序入口文件中（app.js),只需要调用一次 promisifyAll()方法 </span>
<span class="token comment">// 即可实现异步API 的Promise化 </span>
<span class="token comment">// 按需导入一个方法 </span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> promisifyAll <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'miniprogram-api-promise'</span> 
<span class="token comment">// 声明一个常量，为一个空对象， </span>
<span class="token comment">// 并在wx顶级对象下添加一个属性p也指向该空对象，使所有成员都可以使用该对象 </span>
<span class="token keyword">const</span> wxp <span class="token operator">=</span> wx<span class="token punctuation">.</span>p <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token comment">// promisify all wx's api </span>
<span class="token comment">// 参数1： wx顶级对象 </span>
<span class="token comment">// 参数2： wxp指向一个空对象 </span>
<span class="token function">promisifyAll</span><span class="token punctuation">(</span>wx<span class="token punctuation">,</span> wxp<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p><strong>4、调用 Promise 化之后的异步 API</strong></p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>van-button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>warning<span class="token punctuation">&quot;</span></span> <span class="token attr-name">bindtap</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>getInfo<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>警告按钮<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>van-button</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">async</span> <span class="token function">getInfo</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> data<span class="token operator">:</span>res <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">await</span> wx<span class="token punctuation">.</span>p<span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        url<span class="token operator">:</span><span class="token string">&quot;https://www.escook.cn/api/get&quot;</span><span class="token punctuation">,</span>
        method<span class="token operator">:</span><span class="token string">'GET'</span><span class="token punctuation">,</span>
        data<span class="token operator">:</span><span class="token punctuation">{</span>
            name<span class="token operator">:</span><span class="token string">'zs'</span><span class="token punctuation">,</span>
            age<span class="token operator">:</span><span class="token number">19</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h2 id="_3、全局数据共享"><a href="#_3、全局数据共享" class="header-anchor">#</a> 3、<strong>全局数据共享</strong></h2> <h3 id="_3-1、-什么是全局数据共享"><a href="#_3-1、-什么是全局数据共享" class="header-anchor">#</a> 3.1、 <strong>什么是全局数据共享</strong></h3> <p><strong>全局数据共享</strong>（又叫做：状态管理）是为了<strong>解决组件之间数据共享</strong>的问题。</p> <img src="assets/image-20210730062756626.png" alt="image-20210730062756626" style="zoom:67%;"> <p>开发中常用的全局数据共享方案有： Vuex 、 Redux 、 MobX 等。</p> <p>在小程序中，可使用 mobx-miniprogram 配合 mobx-miniprogram-bindings 实现全局数据共享。其</p> <p>中：</p> <ul><li><p>mobx-miniprogram 用来创建 Store 实例对象</p></li> <li><p>mobx-miniprogram-bindings 用来把 Store 中的共享数据或方法，绑定到组件或页面中使用</p></li></ul> <h3 id="_3-2、安装mobx"><a href="#_3-2、安装mobx" class="header-anchor">#</a> 3.2、安装Mobx</h3> <p>在项目中运行如下的命令，安装 MobX 相关的包：</p> <div class="language-ssh line-numbers-mode"><pre class="language-text"><code>npm install --save mobx-miniprogram@4.13.2 mobx-miniprogram-bindings@1.2.1
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>注意： MobX 相关的包安装完毕之后，记得删除 miniprogram_npm 目录后，<strong>重新构建</strong> npm 。</p> <h3 id="_3-3、构建mobx的store实例"><a href="#_3-3、构建mobx的store实例" class="header-anchor">#</a> 3.3、构建Mobx的Store实例</h3> <p>在项目根目录下新建store文件夹，并且新建 store.js 文件</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 按需导入第三方包的方法  observable action</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> observable<span class="token punctuation">,</span>action <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'mobx-miniprogram'</span>

<span class="token comment">// 创建Store实例对象，并导出</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token function">observable</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token comment">// 核心概念1：共享数据字段</span>
  numA<span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span>
  numB<span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">,</span>
  <span class="token comment">// 核心概念2：计算属性</span>
  <span class="token comment">// 在计算属性的方法前，必须添加get修饰符，代码sum的值是只读的，无法进行修改</span>
  <span class="token comment">// 计算属性sum  依赖numA和numB的值，因此sum函数返回值就是最终的值</span>
  <span class="token keyword">get</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>numA <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>numB
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// 核心概念3：action方法</span>
  <span class="token comment">// 定义actions方法，用来修改store中的数据</span>
  updateNum1<span class="token operator">:</span><span class="token function">action</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">step</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>numA <span class="token operator">+=</span> step
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  updateNum2<span class="token operator">:</span><span class="token function">action</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">step</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>numB <span class="token operator">+=</span> step
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><h3 id="_3-3、使用store的成员"><a href="#_3-3、使用store的成员" class="header-anchor">#</a> 3.3、使用Store的成员</h3> <p><strong>1、页面中使用</strong></p> <ul><li>页面的<code>js</code>文件中</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 1. 首先 导入第三方包，将数据绑定到页面</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> createStoreBindings <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'mobx-miniprogram-bindings'</span>
<span class="token comment">// 2. 其次 在页面的js文件的头部导入仓库实例对象</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> store <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'../../store/store'</span>

<span class="token comment">// 3. 绑定操作： 将仓库的东西绑定到页面中，在页面的js文件的Page方法中</span>
<span class="token function">Page</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token comment">/**
   * 页面的初始数据
   */</span>
  data<span class="token operator">:</span> <span class="token punctuation">{</span>

  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token comment">/**
   * 生命周期函数--监听页面加载
   */</span>
  <span class="token function-variable function">onLoad</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 调用createStoreBindings方法</span>
    <span class="token comment">// 参数1: 绑定给谁： 当前页面this</span>
    <span class="token comment">// 参数2：对象 { store：容器， fields:数据，  actions:方法 } </span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>storeBindings <span class="token operator">=</span> <span class="token function">createStoreBindings</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span><span class="token punctuation">{</span>
      <span class="token comment">// 映射容器的实例</span>
      store<span class="token punctuation">,</span>
      <span class="token comment">// 映射容器的数据字段</span>
      fields<span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">'numA'</span><span class="token punctuation">,</span><span class="token string">'numB'</span><span class="token punctuation">,</span><span class="token string">'sum'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token comment">// 映射容器修改的方法</span>
      actions<span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">'updateNum1'</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">/**
   * 生命周期函数--监听页面卸载
   */</span>
  <span class="token function-variable function">onUnload</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 使用this.storeBindings,得到绑定对象</span>
    <span class="token comment">// 调用绑定对象的destroyStoreBindings 方法，进行清理销毁的工作</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>storeBindings<span class="token punctuation">.</span><span class="token function">destroyStoreBindings</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// 事件处理函数，触发action</span>
  <span class="token function">btnHandler1</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 使用仓库的中的方法，并传递数据</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">updateNum1</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>    
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br></div></div><ul><li>页面的 wxml 文件中</li></ul> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token comment">&lt;!-- 使用仓库中的数据 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span><span class="token punctuation">&gt;</span></span>{{numA}} + {{numB}} = {{sum}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>van-button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>primary<span class="token punctuation">&quot;</span></span> <span class="token attr-name">bindtap</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>btnHandler1<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>numA+100<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>van-button</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>2、组件中使用</strong></p> <ul><li>组件的<code>.js</code>文件中</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 1. 按需导入仓库实例</span>
<span class="token comment">// 2. 在组件的behaviors节点 实现自动绑定</span>
<span class="token comment">// 3. 在 storeBindings 节点指定要绑定的store和要绑定的数据及方法</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> storeBindingsBehavior <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'mobx-miniprogram-bindings'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> store <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'../../store/store'</span>

<span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token comment">// 通过 storeBindingsBehavior 来实现自动绑定</span>
  behaviors<span class="token operator">:</span><span class="token punctuation">[</span>storeBindingsBehavior<span class="token punctuation">]</span><span class="token punctuation">,</span>
  storeBindings<span class="token operator">:</span><span class="token punctuation">{</span>
      store<span class="token punctuation">,</span>    <span class="token comment">// 指定要绑定的store</span>
      fields<span class="token operator">:</span><span class="token punctuation">{</span>  <span class="token comment">// 指定要绑定的数据字段和计算属性</span>
        <span class="token function-variable function">numA</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span>store<span class="token punctuation">.</span>numA<span class="token punctuation">,</span>    <span class="token comment">// 绑定字段方式1</span>
        <span class="token function-variable function">numB</span><span class="token operator">:</span> <span class="token parameter">store</span><span class="token operator">=&gt;</span>store<span class="token punctuation">.</span>numB<span class="token punctuation">,</span> <span class="token comment">// 绑定字段方式2</span>
        sum<span class="token operator">:</span><span class="token string">'sum'</span>  <span class="token comment">// 绑定字段方式3</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      actions<span class="token operator">:</span><span class="token punctuation">{</span>  <span class="token comment">// 指定要绑定的方法</span>
        updateNum2<span class="token operator">:</span><span class="token string">'updateNum2'</span>
      <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">/**
   * 组件的方法列表
   */</span>
  methods<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">btnHandler2</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token comment">// 直接使用this调用仓库中的方法</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">updateNum2</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><ul><li>组件的<code>.wxml</code>中</li></ul> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token comment">&lt;!-- 组件的 .wxml 结构 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span><span class="token punctuation">&gt;</span></span>{{ numA }} + {{ numB }} = {{ sum }} <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>van-button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>primary<span class="token punctuation">&quot;</span></span> <span class="token attr-name">bindtap</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>btnHandler2<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>numB+20<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>van-button</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="_4、分包加载"><a href="#_4、分包加载" class="header-anchor">#</a> 4、分包加载</h2> <h3 id="_4-1、基础概念"><a href="#_4-1、基础概念" class="header-anchor">#</a> 4.1、基础概念</h3> <h4 id="分包概念和好处"><a href="#分包概念和好处" class="header-anchor">#</a> 分包概念和好处</h4> <ol><li><p>什么是分包</p> <p>分包指的是把一个 <strong>完整的小程序项目</strong>，按照需求<strong>划分为不同的子包</strong>，在构建时打包成不同的分包，<strong>用户在使用时按需进行加载</strong></p></li> <li><p>分包的好处</p> <ul><li>可以优化小程序首次启动的下载时间</li> <li>在多团队共同开发时可以更好的解耦协作</li></ul></li></ol> <h4 id="分包前后项目的构成"><a href="#分包前后项目的构成" class="header-anchor">#</a> 分包前后项目的构成</h4> <ol><li><p>分包前项目的构成</p> <p>分包前，小程序项目中 所有的页面 和 资源 都被打包到了一起，导致整个项目体积过大，影响小程序首次启动的下载时间</p> <p><img src="/wxxcx-docs/assets/img/image-20210730180414330.7b5c96c8.png" alt="image-20210730180414330"></p></li> <li><p>分包后项目的构成</p> <p>分包后，小程序项目由 <strong>1 个主包 + 多个分包</strong> 组成：</p> <ul><li><p>主包：一般只包含项目的<strong>启动页面</strong>或 <strong>TabBar 页面</strong>、以及所有分包都需要用到的一些<strong>公共资源</strong></p></li> <li><p>分包：只包含和当前分包有关的页面和私有资源</p></li></ul></li></ol> <p><img src="/wxxcx-docs/assets/img/image-20210730180622739.76a6d911.png" alt="image-20210730180622739"></p> <h4 id="分包的加载规则"><a href="#分包的加载规则" class="header-anchor">#</a> 分包的加载规则</h4> <ol><li><p>在小程序启动时，默认会下载 <strong>主包并启动主包内页面</strong></p></li> <li><p>当用户进入分包内某个页面时，客户端会把对应分包下载下来，下载完成后再进行展示</p> <ul><li>非 tabBar 页面可以按照功能的不同，划分为不同的分包之后，进行按需下载</li></ul></li></ol> <h4 id="分包的体积限制"><a href="#分包的体积限制" class="header-anchor">#</a> 分包的体积限制</h4> <p>目前，小程序分包的大小有以下两个限制：</p> <ul><li>整个小程序所有分包大小不超过 20M （主包 + 所有分包）</li> <li>单个分包/主包大小不能超过2M</li></ul> <h3 id="_4-2、使用分包"><a href="#_4-2、使用分包" class="header-anchor">#</a> 4.2、使用分包</h3> <h4 id="配置方法"><a href="#配置方法" class="header-anchor">#</a> 配置方法</h4> <p>在 app.json 的 <strong>subpackages</strong> 节点中声明分包的结构</p> <p><img src="/wxxcx-docs/assets/img/image-20210730181411430.2eeb8d4e.png" alt="image-20210730181411430"></p> <h4 id="打包原则"><a href="#打包原则" class="header-anchor">#</a> 打包原则</h4> <p>① 小程序会按 subpackages 的配置进行分包， subpackages 之外的目录将被打包到主包中</p> <p>② 主包也可以有自己的 pages （即最外层的 pages 字段）</p> <p>③ tabBar 页面必须在主包内</p> <p>④ 分包之间不能互相嵌套</p> <h4 id="引用原则"><a href="#引用原则" class="header-anchor">#</a> 引用原则</h4> <p>① 主包无法引用分包内的私有资源</p> <p>② 分包之间不能相互引用私有资源</p> <p>③ 分包可以引用主包内的公共资源</p> <p><img src="/wxxcx-docs/assets/img/image-20210730181945393.518340b0.png" alt="image-20210730181945393"></p> <h3 id="_4-3、独立分包"><a href="#_4-3、独立分包" class="header-anchor">#</a> 4.3、独立分包</h3> <p><strong>1、什么是独立分包</strong></p> <p><strong>独立分包</strong>本质上也是分包，只不过它比较特殊，可以独立于主包和其他分包而<strong>单独运行</strong>。</p> <p><img src="/wxxcx-docs/assets/img/image-20210730182520639.b9cbe356.png" alt="image-20210730182520639"></p> <p><strong>2.</strong> <strong>独立分包和普通分包的区别</strong></p> <p>最主要的区别：<strong>是否依赖于主包才能运行</strong></p> <ul><li><p>普通分包必须依赖于主包才能运行</p></li> <li><p>独立分包可以在不下载主包的情况下，独立运行</p></li></ul> <p><strong>3.</strong> <strong>独立分包的应用场景</strong></p> <p>开发者可以按需，将某些<strong>具有一定功能独立性的页面配置到独立分包中</strong>。原因如下：</p> <ul><li><p>当小程序从普通的分包页面启动时，需要首先下载主包</p></li> <li><p>而独立分包<strong>不依赖主包</strong>即可运行，可以<strong>很大程度上提升分包页面的启动速度</strong></p></li></ul> <p><strong>注意</strong>：<strong>一个小程序中可以有多个独立分包</strong>。</p> <p><strong>4.</strong> <strong>独立分包的配置方法</strong></p> <p>和普通分包对比, 独立分包就是在 subpackages 数组的某个元素中, 配置 independent 为true即可</p> <p><img src="/wxxcx-docs/assets/img/image-20210731054157634.06f8dda2.png" alt="image-20210731054157634"></p> <p><strong>5.</strong> <strong>引用原则</strong></p> <p>独立分包和普通分包以及主包之间，是<strong>相互隔绝</strong>的，不能相互引用彼此的资源！例如：</p> <p>① 主包无法引用独立分包内的私有资源</p> <p>② 独立分包之间，不能相互引用私有资源</p> <p>③ 独立分包和普通分包之间，不能相互引用私有资源</p> <p>**④ 特别注意：**独立分包中不能引用主包内的公共资源</p> <h3 id="_4-4、分包预加载"><a href="#_4-4、分包预加载" class="header-anchor">#</a> 4.4、分包预加载</h3> <p><strong>1.</strong> <strong>什么是分包预下载</strong></p> <p>分包预下载指的是：在进入小程序的某个页面时，由框架自动预下载可能需要的分包，从而<strong>提升</strong>进入后</p> <p>续分包页面时的启动速度。</p> <p><strong>2.</strong> <strong>配置分包的预下载</strong></p> <p>预下载分包的行为，会在进入指定的页面时触发。在 app.json 中，使用 preloadRule 节点定义分包</p> <p>的预下载规则，示例代码如下：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token punctuation">{</span>   
    <span class="token comment">// 分包预下载的规则 </span>
	<span class="token string">&quot;preloadRule&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> 
        <span class="token comment">// 触发分包预下载的页面路径 </span>
        <span class="token string">&quot;page/concact/concact&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> 
            <span class="token comment">// network 表示在指定的网络模式下进行预下载 </span>
            <span class="token comment">// 可选值有： all(不限网络)和wifi(仅 wifi 模式下进行预下载) 默认值为： wifi </span>
            <span class="token string">&quot;network&quot;</span><span class="token operator">:</span> <span class="token string">&quot;all&quot;</span><span class="token punctuation">,</span> 
            <span class="token comment">//packages 表示进入页面后， 预下载哪些分包 可以通过root 或name 指定预下载哪些分包</span>
            <span class="token string">&quot;packages&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;pkgA&quot;</span><span class="token punctuation">]</span> 
        <span class="token punctuation">}</span> 
    <span class="token punctuation">}</span> 
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p><strong>3.</strong> <strong>分包预下载的限制</strong></p> <p>同一个分包中的页面享有共同的<strong>预下载大小限额</strong> 2M ，例如：</p> <p><img src="/wxxcx-docs/assets/img/image-20210731055216412.7df338d4.png" alt="image-20210731055216412"></p> <h2 id="_5、自定义tabbar"><a href="#_5、自定义tabbar" class="header-anchor">#</a> 5、自定义TabBar</h2> <h3 id="_5-1、案例展示"><a href="#_5-1、案例展示" class="header-anchor">#</a> 5.1、案例展示</h3> <img src="/wxxcx-docs/assets/img/image-20210731055942516.3ed90f7c.png" alt="image-20210731055942516" style="zoom:80%;"> <h3 id="_5-2、基本实现"><a href="#_5-2、基本实现" class="header-anchor">#</a> 5.2、基本实现</h3> <p>自定义 tabBar 分为 3 大步骤，分别是：</p> <p>① 配置信息</p> <ul><li><p>在 app.json 中的 tabBar 项指定 custom 字段，同时其余 tabBar 相关配置也补充完整。</p></li> <li><p>所有 tab 页的 json 里需声明 usingComponents 项，也可以在 app.json 全局开启。</p></li></ul> <blockquote><p>在自定义 tabBar 模式下</p></blockquote> <ul><li>为了保证低版本兼容以及区分哪些页面是 tab 页， tabBar 的相关配置项需完整声明，但这些字段不会作用于自定义 tabBar 的渲染。</li> <li>此时需要开发者提供一个自定义组件来渲染 tabBar ，所有 tabBar 的样式都由该自定义组件渲染。</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code>  <span class="token string">&quot;tabBar&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;custom&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token string">&quot;list&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token string">&quot;pagePath&quot;</span><span class="token operator">:</span> <span class="token string">&quot;pages/home/home&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;text&quot;</span><span class="token operator">:</span> <span class="token string">&quot;首页&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;iconPath&quot;</span><span class="token operator">:</span> <span class="token string">&quot;/images/tabs/home.png&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;selectedIconPath&quot;</span><span class="token operator">:</span> <span class="token string">&quot;/images/tabs/home-active.png&quot;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token string">&quot;pagePath&quot;</span><span class="token operator">:</span> <span class="token string">&quot;pages/message/message&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;text&quot;</span><span class="token operator">:</span> <span class="token string">&quot;消息&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;iconPath&quot;</span><span class="token operator">:</span> <span class="token string">&quot;/images/tabs/message.png&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;selectedIconPath&quot;</span><span class="token operator">:</span> <span class="token string">&quot;/images/tabs/message-active.png&quot;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token string">&quot;pagePath&quot;</span><span class="token operator">:</span> <span class="token string">&quot;pages/contact/contact&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;text&quot;</span><span class="token operator">:</span> <span class="token string">&quot;联系我们&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;iconPath&quot;</span><span class="token operator">:</span> <span class="token string">&quot;/images/tabs/contact.png&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;selectedIconPath&quot;</span><span class="token operator">:</span> <span class="token string">&quot;/images/tabs/contact-active.png&quot;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><p>② 添加 tabBar 代码文件</p> <p>在项目根目录下创建custom-tab-bar文件夹, 并创建index组件</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>custom<span class="token operator">-</span>tab<span class="token operator">-</span>bar<span class="token operator">/</span>index<span class="token punctuation">.</span>js 
custom<span class="token operator">-</span>tab<span class="token operator">-</span>bar<span class="token operator">/</span>index<span class="token punctuation">.</span>json 
custom<span class="token operator">-</span>tab<span class="token operator">-</span>bar<span class="token operator">/</span>index<span class="token punctuation">.</span>wxml 
custom<span class="token operator">-</span>tab<span class="token operator">-</span>bar<span class="token operator">/</span>index<span class="token punctuation">.</span>wxss
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>注意: <strong>文件夹的名称和组件的名称都不能改</strong></p> <p>③ 编写 tabBar 代码</p> <blockquote><p>用自定义组件的方式编写即可，该自定义组件完全接管 tabBar 的渲染。另外，自定义组件新增getTabBar 接口，可获取当前页面下的自定义 tabBar 组件实例。</p></blockquote> <p>详细步骤，可以参考小程序官方给出的文档：</p> <p>https://developers.weixin.qq.com/miniprogram/dev/framework/ability/custom-tabbar.html</p> <h3 id="_5-3、基于vant-waapp渲染tabbar"><a href="#_5-3、基于vant-waapp渲染tabbar" class="header-anchor">#</a> 5.3、基于vant-waapp渲染tabbar</h3> <h4 id="渲染基础结构"><a href="#渲染基础结构" class="header-anchor">#</a> 渲染基础结构</h4> <ul><li>在 app.json/index.json 文件中，注册组件</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token string">&quot;usingComponents&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> 
    <span class="token string">&quot;van-tabbar&quot;</span><span class="token operator">:</span> <span class="token string">&quot;@vant/weapp/tabbar/index&quot;</span><span class="token punctuation">,</span> 
    <span class="token string">&quot;van-tabbar-item&quot;</span><span class="token operator">:</span> <span class="token string">&quot;@vant/weapp/tabbar-item/index&quot;</span> 
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li>在组件的 wxml 文件中使用组件</li></ul> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token comment">&lt;!--自定义tabBar--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>van-tabbar</span> <span class="token attr-name">active</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{ active }}<span class="token punctuation">&quot;</span></span> <span class="token attr-name"><span class="token namespace">bind:</span>change</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>onChange<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>van-tabbar-item</span> <span class="token attr-name">icon</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>home-o<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>标签<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>van-tabbar-item</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>van-tabbar-item</span> <span class="token attr-name">icon</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>search<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>标签<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>van-tabbar-item</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>van-tabbar-item</span> <span class="token attr-name">icon</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>friends-o<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>标签<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>van-tabbar-item</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>van-tabbar-item</span> <span class="token attr-name">icon</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>setting-o<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>标签<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>van-tabbar-item</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>van-tabbar</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><ul><li>在组件的js中定义变量和事件</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token comment">// 组件的初始数据</span>
    data<span class="token operator">:</span><span class="token punctuation">{</span>
        active<span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span>
        <span class="token string">&quot;list&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token punctuation">{</span>
            <span class="token string">&quot;pagePath&quot;</span><span class="token operator">:</span> <span class="token string">&quot;/pages/home/home&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;text&quot;</span><span class="token operator">:</span> <span class="token string">&quot;首页&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;iconPath&quot;</span><span class="token operator">:</span> <span class="token string">&quot;/images/tabs/home.png&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;selectedIconPath&quot;</span><span class="token operator">:</span> <span class="token string">&quot;/images/tabs/home-active.png&quot;</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token punctuation">{</span>
            <span class="token string">&quot;pagePath&quot;</span><span class="token operator">:</span> <span class="token string">&quot;/pages/message/message&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;text&quot;</span><span class="token operator">:</span> <span class="token string">&quot;消息&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;iconPath&quot;</span><span class="token operator">:</span> <span class="token string">&quot;/images/tabs/message.png&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;selectedIconPath&quot;</span><span class="token operator">:</span> <span class="token string">&quot;/images/tabs/message-active.png&quot;</span><span class="token punctuation">,</span>
             info<span class="token operator">:</span> <span class="token number">0</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token punctuation">{</span>
            <span class="token string">&quot;pagePath&quot;</span><span class="token operator">:</span> <span class="token string">&quot;/pages/contact/contact&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;text&quot;</span><span class="token operator">:</span> <span class="token string">&quot;联系我们&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;iconPath&quot;</span><span class="token operator">:</span> <span class="token string">&quot;/images/tabs/contact.png&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;selectedIconPath&quot;</span><span class="token operator">:</span> <span class="token string">&quot;/images/tabs/contact-active.png&quot;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// 组件的方法列表</span>
    methods<span class="token operator">:</span><span class="token punctuation">{</span>
        <span class="token function">onChange</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token comment">// event.detail 的值为当前选中的索引</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span> active<span class="token operator">:</span> event<span class="token punctuation">.</span>detail <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br></div></div><h4 id="渲染tabbar里面的item"><a href="#渲染tabbar里面的item" class="header-anchor">#</a> 渲染TabBar里面的Item</h4> <ul><li>组件js里面定义数据</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    options<span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token comment">// 处理样式 修改问题</span>
        styleIsolation<span class="token operator">:</span> <span class="token string">'shared'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// 组件的初始数据</span>
    data<span class="token operator">:</span><span class="token punctuation">{</span>
        active<span class="token operator">:</span><span class="token number">0</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// 组件的方法列表</span>
    methods<span class="token operator">:</span><span class="token punctuation">{</span>
        <span class="token function">onChange</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token comment">// event.detail 的值为当前选中的索引</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span> active<span class="token operator">:</span> event<span class="token punctuation">.</span>detail <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><ul><li>组件的wxml中渲染</li></ul> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token comment">&lt;!--自定义tabBar--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>van-tabbar</span> <span class="token attr-name">active</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{active}}<span class="token punctuation">&quot;</span></span> <span class="token attr-name"><span class="token namespace">bind:</span>change</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>onChange<span class="token punctuation">&quot;</span></span> <span class="token attr-name">active-color</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>#13A7A0<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>van-tabbar-item</span> <span class="token attr-name"><span class="token namespace">wx:</span>for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{list}}<span class="token punctuation">&quot;</span></span> <span class="token attr-name"><span class="token namespace">wx:</span>key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>index<span class="token punctuation">&quot;</span></span> <span class="token attr-name">info</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{item.info ? item.info : <span class="token punctuation">'</span><span class="token punctuation">'</span>}}<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span> <span class="token attr-name">slot</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>icon<span class="token punctuation">&quot;</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{item.iconPath}}<span class="token punctuation">&quot;</span></span> <span class="token attr-name">mode</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>aspectFit<span class="token punctuation">&quot;</span></span> <span class="token style-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token style language-css"><span class="token property">width</span><span class="token punctuation">:</span> 25px<span class="token punctuation">;</span> <span class="token property">height</span><span class="token punctuation">:</span> 25px<span class="token punctuation">;</span></span><span class="token punctuation">&quot;</span></span></span> <span class="token punctuation">/&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span> <span class="token attr-name">slot</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>icon-active<span class="token punctuation">&quot;</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{item.selectedIconPath}}<span class="token punctuation">&quot;</span></span> <span class="token attr-name">mode</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>aspectFit<span class="token punctuation">&quot;</span></span> <span class="token style-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token style language-css"><span class="token property">width</span><span class="token punctuation">:</span> 25px<span class="token punctuation">;</span> <span class="token property">height</span><span class="token punctuation">:</span> 25px<span class="token punctuation">;</span></span><span class="token punctuation">&quot;</span></span></span> <span class="token punctuation">/&gt;</span></span>
		{{item.text}}
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>van-tabbar-item</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>van-tabbar</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><ul><li>组件的wxss中</li></ul> <div class="language-css line-numbers-mode"><pre class="language-css"><code><span class="token comment">/* custom-tab-bar/index.wxss */</span>
<span class="token selector">.van-tabbar-item</span> <span class="token punctuation">{</span>
  <span class="token property">--tabbar-item-margin-bottom</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h4 id="渲染仓库中sum作为徽标"><a href="#渲染仓库中sum作为徽标" class="header-anchor">#</a> 渲染仓库中sum作为徽标</h4> <ul><li>组件js中导入 仓库 store 和绑定方法 storeBindingsBehavior，进行数据绑定</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token comment">// 其他...  </span>
  behaviors<span class="token operator">:</span> <span class="token punctuation">[</span>storeBindingsBehavior<span class="token punctuation">]</span><span class="token punctuation">,</span>
  storeBindings<span class="token operator">:</span> <span class="token punctuation">{</span>
    store<span class="token punctuation">,</span>
    fields<span class="token operator">:</span> <span class="token punctuation">{</span>
      sum<span class="token operator">:</span> <span class="token string">'sum'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  observers<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string">'sum'</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">val</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token string">'list[1].info'</span><span class="token operator">:</span> val
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// 其他...</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h4 id="实现切换页面"><a href="#实现切换页面" class="header-anchor">#</a> 实现切换页面</h4> <ul><li>实现TabBar的点击页面切换</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token function">onChange</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// event.detail 的值为当前选中项的索引</span>
    wx<span class="token punctuation">.</span><span class="token function">switchTab</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        url<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>list<span class="token punctuation">[</span>event<span class="token punctuation">.</span>detail<span class="token punctuation">]</span><span class="token punctuation">.</span>pagePath<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h4 id="tabbar索引不准确问题"><a href="#tabbar索引不准确问题" class="header-anchor">#</a> TabBar索引不准确问题</h4> <p>我们发现点击切换页面的时候，底部的tabBar的索引不准确，所以需要优化一下。</p> <ul><li>仓库中增加  activeTabBarIndex属性  和 updateActiveTabBarIndex 这个action 方法</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 在这个 JS 文件中，专门来创建 Store 的实例对象</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> observable<span class="token punctuation">,</span> action <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'mobx-miniprogram'</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token function">observable</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token comment">// 数据字段</span>
  numA<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
  numB<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
  activeTabBarIndex<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token comment">// &lt;======= 增加</span>
  <span class="token comment">// 计算属性</span>
  <span class="token keyword">get</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>numA <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>numB
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// actions 函数，专门来修改 store 中数据的值</span>
  updateNum1<span class="token operator">:</span> <span class="token function">action</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">step</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>numA <span class="token operator">+=</span> step
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  updateNum2<span class="token operator">:</span> <span class="token function">action</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">step</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>numB <span class="token operator">+=</span> step
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  updateActiveTabBarIndex<span class="token operator">:</span> <span class="token function">action</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">index</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment">// &lt;======= 增加</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>activeTabBarIndex <span class="token operator">=</span> index
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><ul><li>组件的js中</li></ul> <div class="language-js line-numbers-mode"><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlighted"> </div><br><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlighted"> </div><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlighted"> </div><br><br><br><br><br><br><br><br></div><pre class="language-js"><code><span class="token comment">// custom-tab-bar/index.js</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> storeBindingsBehavior <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'mobx-miniprogram-bindings'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> store <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'../store/store'</span>

<span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  options<span class="token operator">:</span> <span class="token punctuation">{</span>
    styleIsolation<span class="token operator">:</span> <span class="token string">'shared'</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  behaviors<span class="token operator">:</span> <span class="token punctuation">[</span>storeBindingsBehavior<span class="token punctuation">]</span><span class="token punctuation">,</span>
  storeBindings<span class="token operator">:</span> <span class="token punctuation">{</span>
    store<span class="token punctuation">,</span>
    fields<span class="token operator">:</span> <span class="token punctuation">{</span>
      sum<span class="token operator">:</span> <span class="token string">'sum'</span><span class="token punctuation">,</span>
      active<span class="token operator">:</span> <span class="token string">'activeTabBarIndex'</span>    <span class="token comment">// 使用仓库的数字作为激活下标位置  &lt;==== 增加   </span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    actions<span class="token operator">:</span> <span class="token punctuation">{</span>
      updateActive<span class="token operator">:</span> <span class="token string">'updateActiveTabBarIndex'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  observers<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string">'sum'</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">val</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token string">'list[1].info'</span><span class="token operator">:</span> val
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">/**
   * 组件的属性列表
   */</span>
  properties<span class="token operator">:</span> <span class="token punctuation">{</span>

  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token comment">/**
   * 组件的初始数据
   */</span>
  data<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// active:0,   // 注释，因为使用仓库中的  &lt;==== 注释   </span>
    <span class="token string">&quot;list&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token string">&quot;pagePath&quot;</span><span class="token operator">:</span> <span class="token string">&quot;/pages/home/home&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;text&quot;</span><span class="token operator">:</span> <span class="token string">&quot;首页&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;iconPath&quot;</span><span class="token operator">:</span> <span class="token string">&quot;/images/tabs/home.png&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;selectedIconPath&quot;</span><span class="token operator">:</span> <span class="token string">&quot;/images/tabs/home-active.png&quot;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token string">&quot;pagePath&quot;</span><span class="token operator">:</span> <span class="token string">&quot;/pages/message/message&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;text&quot;</span><span class="token operator">:</span> <span class="token string">&quot;消息&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;iconPath&quot;</span><span class="token operator">:</span> <span class="token string">&quot;/images/tabs/message.png&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;selectedIconPath&quot;</span><span class="token operator">:</span> <span class="token string">&quot;/images/tabs/message-active.png&quot;</span><span class="token punctuation">,</span>
        info<span class="token operator">:</span> <span class="token number">0</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token string">&quot;pagePath&quot;</span><span class="token operator">:</span> <span class="token string">&quot;/pages/contact/contact&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;text&quot;</span><span class="token operator">:</span> <span class="token string">&quot;联系我们&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;iconPath&quot;</span><span class="token operator">:</span> <span class="token string">&quot;/images/tabs/contact.png&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;selectedIconPath&quot;</span><span class="token operator">:</span> <span class="token string">&quot;/images/tabs/contact-active.png&quot;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token comment">/**
   * 组件的方法列表
   */</span>
  methods<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">onChange</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// event.detail 的值为当前选中项的索引</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">updateActive</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>detail<span class="token punctuation">)</span>   <span class="token comment">// 更新仓库中索引下标  &lt;====增加</span>
      wx<span class="token punctuation">.</span><span class="token function">switchTab</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        url<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>list<span class="token punctuation">[</span>event<span class="token punctuation">.</span>detail<span class="token punctuation">]</span><span class="token punctuation">.</span>pagePath<span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br></div></div></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/wxxcx-docs/assets/js/app.d92135fc.js" defer></script><script src="/wxxcx-docs/assets/js/3.8ee8425d.js" defer></script><script src="/wxxcx-docs/assets/js/5.5b96994b.js" defer></script>
  </body>
</html>
